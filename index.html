<!DOCTYPE html>
<!--
====================================================
Coaching Dashboard
Version: 1.1.0
Update:
- Long-form professional risk questions
- Clean production validation
- Full body composition summary
====================================================
-->

<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coaching Dashboard v1.1.0</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-emerald-50 to-green-100 min-h-screen p-6">

<div class="max-w-5xl mx-auto bg-white rounded-3xl shadow-2xl p-8">

<h1 class="text-3xl font-bold text-center text-emerald-700 mb-6">
Coaching Dashboard
</h1>

<div class="flex justify-center space-x-4 mb-8">
<button onclick="showTab(1)" class="tab-btn">Body</button>
<button onclick="showTab(2)" class="tab-btn">Risk</button>
<button onclick="showTab(3)" class="tab-btn">Summary</button>
</div>

<!-- ================= BODY ================= -->

<div id="tab1">

<input id="clientNameInput" type="text" placeholder="ชื่อผู้รับการประเมิน" class="input">
<input id="weightInput" type="number" placeholder="น้ำหนัก (kg)" class="input">
<input id="heightInput" type="number" placeholder="ส่วนสูง (cm)" class="input">
<input id="ageInput" type="number" placeholder="อายุ" class="input">
<input id="bodyfatInput" type="number" placeholder="%ไขมัน" class="input">
<input id="muscleInput" type="number" placeholder="มวลกล้ามเนื้อ (kg)" class="input">

<select id="genderInput" class="input">
<option value="">เลือกเพศ</option>
<option value="female">หญิง</option>
<option value="male">ชาย</option>
</select>

<button onclick="analyzeBody()" class="primary-btn">
บันทึกข้อมูล
</button>

<div id="bodyResult" class="mt-4 text-green-700 text-sm"></div>

</div>

<!-- ================= RISK ================= -->

<div id="tab2" class="hidden">
<div id="riskContainer"></div>
<button onclick="calculateRisk()" class="secondary-btn">
ประเมินผล
</button>
<div id="riskResult" class="mt-4 text-green-700 text-sm"></div>
</div>

<!-- ================= SUMMARY ================= -->

<div id="tab3" class="hidden">
<div id="summarySection" class="mt-4 p-4 bg-emerald-50 rounded-xl text-sm"></div>
</div>

</div>

<script>

/* =====================================================
   GLOBAL STATE
===================================================== */

const APP_VERSION="1.1.0";
let globalData={body:null,risk:null};

/* =====================================================
   UI STYLING
===================================================== */

document.querySelectorAll(".input").forEach(i=>{
i.classList.add("w-full","p-2","border","rounded-xl","mb-2");
});

document.querySelectorAll(".tab-btn").forEach(btn=>{
btn.classList.add("px-4","py-2","rounded-xl","bg-gray-300");
});

document.querySelectorAll(".primary-btn").forEach(btn=>{
btn.classList.add("bg-emerald-600","text-white","w-full","py-2","rounded-xl","mt-2");
});

document.querySelectorAll(".secondary-btn").forEach(btn=>{
btn.classList.add("bg-orange-500","text-white","w-full","py-2","rounded-xl","mt-4");
});

function showTab(n){
["tab1","tab2","tab3"].forEach(t=>{
document.getElementById(t).classList.add("hidden");
});
document.getElementById("tab"+n).classList.remove("hidden");
if(n===3) generateSummary();
}

/* =====================================================
   VALIDATION
===================================================== */

function isValidNumber(v,min,max){
if(v===""||isNaN(v)||v<min||v>max) return false;
return true;
}

/* =====================================================
   BODY ANALYSIS
===================================================== */

function analyzeBody(){

let w=parseFloat(weightInput.value);
let h=parseFloat(heightInput.value);
let a=parseInt(ageInput.value);
let bf=parseFloat(bodyfatInput.value);
let m=parseFloat(muscleInput.value);
let g=genderInput.value;

if(!isValidNumber(w,30,250)) return alert("น้ำหนักไม่ถูกต้อง (30-250 kg)");
if(!isValidNumber(h,120,220)) return alert("ส่วนสูงไม่ถูกต้อง (120-220 cm)");
if(!isValidNumber(a,10,100)) return alert("อายุไม่ถูกต้อง (10-100 ปี)");
if(!isValidNumber(bf,3,60)) return alert("%ไขมันไม่ถูกต้อง (3-60%)");
if(!isValidNumber(m,5,80)) return alert("มวลกล้ามเนื้อไม่ถูกต้อง");
if(!g) return alert("กรุณาเลือกเพศ");

let H=h/100;
let weightMin=18.5*H*H;
let weightMax=22.9*H*H;

let stdWeight=(g==="male")?H*H*22:H*H*21;
let muscleMin=(g==="male")?stdWeight*0.42:stdWeight*0.35;
let muscleMax=(g==="male")?stdWeight*0.48:stdWeight*0.40;

let fatPercentMax=(g==="male")?20:28;
let fatKgMax=w*(fatPercentMax/100);
let currentFat=w*(bf/100);

let fatAdvice=currentFat>fatKgMax
? "ควรลดไขมันประมาณ "+(currentFat-fatKgMax).toFixed(1)+" กก."
: "ไขมันอยู่ในช่วงมาตรฐาน";

let muscleAdvice=m<muscleMin
? "ควรเพิ่มกล้ามเนื้ออย่างน้อย "+(muscleMin-m).toFixed(1)+" กก."
: "กล้ามเนื้ออยู่ในช่วงมาตรฐาน";

globalData.body={
w,h,a,bf,m,g,
weightMin,weightMax,
muscleMin,muscleMax,
fatAdvice,muscleAdvice
};

bodyResult.innerHTML="✅ บันทึกข้อมูลเรียบร้อยแล้ว";
}

/* =====================================================
   LONG FORM RISK SECTION
===================================================== */

const riskData=[{
title:"Nutrition (โภชนาการ)",
description:"วิเคราะห์เพื่อควบคุมระดับน้ำตาลและลดการสะสมไขมัน",
questions:[
"ในหนึ่งสัปดาห์ที่ผ่านมา คุณสามารถหลีกเลี่ยงอาหารที่มีค่าดัชนีน้ำตาลสูง เช่น ข้าวขาว ขนมปังขาว น้ำหวาน หรือเบเกอรี่ ได้มากน้อยเพียงใด?",
"คุณสามารถจัดสัดส่วนจานอาหารตามหลัก 2:1:1 (ผัก 2 : ข้าว 1 : โปรตีน 1) ได้อย่างสม่ำเสมอเพียงใด?",
"คุณมั่นใจว่าคุณได้รับโปรตีนคุณภาพดีเพียงพอ เพื่อรักษาหรือเพิ่มมวลกล้ามเนื้อ ได้มากน้อยเพียงใด?"
]
},
{
title:"Activity (กิจกรรม)",
description:"วิเคราะห์เพื่อเพิ่ม BMR และลดโอกาสโยโย่",
questions:[
"คุณสามารถออกกำลังกายแบบคาร์ดิโออย่างน้อย 150 นาทีต่อสัปดาห์ ได้มากน้อยเพียงใด?",
"คุณสามารถทำเวทเทรนนิ่งอย่างน้อย 2 ครั้งต่อสัปดาห์ ได้มากน้อยเพียงใด?",
"ในวันทำงาน คุณสามารถลุกขยับร่างกายทุก 1 ชั่วโมง ได้มากน้อยเพียงใด?"
]
},
{
title:"Sleep (การนอน)",
description:"วิเคราะห์เพื่อรีเซ็ตฮอร์โมนความหิว",
questions:[
"คุณสามารถนอนหลับต่อเนื่อง 7–9 ชั่วโมงต่อคืน ได้มากน้อยเพียงใด?",
"คุณตื่นแล้วรู้สึกสดชื่นพร้อมเริ่มต้นวันใหม่ ได้มากน้อยเพียงใด?",
"คุณสามารถเข้านอนและตื่นนอนตรงเวลาอย่างสม่ำเสมอ ได้มากน้อยเพียงใด?"
]
},
{
title:"Stress (ความเครียด)",
description:"วิเคราะห์เพื่อควบคุมคอร์ติซอล",
questions:[
"คุณสามารถจัดการความเครียดจากงานหรือชีวิตส่วนตัว ได้มากน้อยเพียงใด?",
"เมื่อเครียด คุณสามารถหลีกเลี่ยงการกินตามอารมณ์ ได้มากน้อยเพียงใด?",
"คุณสามารถจัดสรรเวลาผ่อนคลายจิตใจทุกวัน ได้มากน้อยเพียงใด?"
]
},
{
title:"Mindset (ทัศนคติ)",
description:"วิเคราะห์ความยั่งยืน",
questions:[
"คุณให้ความสำคัญกับองค์ประกอบร่างกายมากกว่าน้ำหนัก ได้มากน้อยเพียงใด?",
"คุณเชื่อว่าการปรับไลฟ์สไตล์สำคัญกว่าการอดอาหาร ได้มากน้อยเพียงใด?",
"เมื่อหลุดแผน คุณสามารถกลับเข้าสู่แผนได้ทันที ได้มากน้อยเพียงใด?"
]
},
{
title:"Water (การดื่มน้ำ)",
description:"สนับสนุนระบบเผาผลาญ",
questions:[
"คุณดื่มน้ำอย่างน้อย 1.5–2 ลิตรต่อวัน ได้มากน้อยเพียงใด?",
"คุณสามารถจำกัดเครื่องดื่มหวาน ได้มากน้อยเพียงใด?",
"คุณพกขวดน้ำติดตัวระหว่างวัน ได้มากน้อยเพียงใด?"
]
},
{
title:"Microbiome (ลำไส้)",
description:"ประสิทธิภาพการดูดซึม",
questions:[
"คุณรับประทานผักและผลไม้หลากสี ได้มากน้อยเพียงใด?",
"คุณมีระบบขับถ่ายสม่ำเสมอ ได้มากน้อยเพียงใด?",
"คุณดูแลสมดุลจุลินทรีย์ลำไส้ ได้มากน้อยเพียงใด?"
]
}
];

function initRisk(){
let html="";
riskData.forEach((factor,i)=>{
html+=`<div class="mt-6 p-4 bg-gray-50 rounded-xl">
<h3 class="font-bold text-emerald-700 text-lg">${factor.title}</h3>
<p class="text-sm text-gray-600 mb-3">${factor.description}</p>`;
factor.questions.forEach((q,j)=>{
html+=`
<div class="mb-4">
<label class="block mb-2 leading-relaxed">${j+1}. ${q}</label>
<select class="risk input" data-factor="${i}">
<option value="0">นานๆ ครั้ง</option>
<option value="1">บ่อยเป็นบางช่วง</option>
<option value="2">สม่ำเสมอเกือบทุกวัน</option>
</select>
</div>`;
});
html+="</div>";
});
riskContainer.innerHTML=html;
}
window.onload=initRisk;

function calculateRisk(){
let scores=new Array(riskData.length).fill(0);
document.querySelectorAll(".risk").forEach(s=>{
scores[s.dataset.factor]+=parseInt(s.value);
});
globalData.risk=scores;
riskResult.innerHTML="✅ บันทึกคะแนนเรียบร้อยแล้ว";
}

/* =====================================================
   SUMMARY
===================================================== */

function generateSummary(){

if(!globalData.body||!globalData.risk){
summarySection.innerHTML="กรุณาประเมินให้ครบก่อน";
return;
}

let d=globalData.body;
let name=clientNameInput.value||"ไม่ระบุชื่อ";
let dateString=new Date().toLocaleDateString("th-TH");

let factorList="";
globalData.risk.forEach((score,i)=>{
factorList+=`${riskData[i].title}: ${score}/6<br>`;
});

summarySection.innerHTML=
`
<div class="bg-white p-5 rounded-xl shadow">

<h2 class="text-lg font-bold mb-3">รายงานผลการประเมินสุขภาพ</h2>

ชื่อ: ${name}<br>
วันที่: ${dateString}<br><br>

<h3 class="font-bold">ข้อมูลองค์ประกอบร่างกาย</h3>
น้ำหนัก: ${d.w} kg<br>
ส่วนสูง: ${d.h} cm<br>
อายุ: ${d.a} ปี<br>
เพศ: ${d.g==="male"?"ชาย":"หญิง"}<br>
%ไขมัน: ${d.bf}%<br>
มวลกล้ามเนื้อ: ${d.m} kg<br><br>

<h3 class="font-bold">ค่ามาตรฐาน</h3>
ช่วงน้ำหนักที่เหมาะสม: ${d.weightMin.toFixed(1)} - ${d.weightMax.toFixed(1)} kg<br>
ช่วงมวลกล้ามเนื้อมาตรฐาน: ${d.muscleMin.toFixed(1)} - ${d.muscleMax.toFixed(1)} kg<br><br>

<h3 class="font-bold">สรุปการประเมินร่างกาย</h3>
${d.fatAdvice}<br>
${d.muscleAdvice}<br><br>

<h3 class="font-bold">คะแนน 7 ปัจจัยสุขภาพ</h3>
${factorList}

</div>
`;
}

</script>

</body>
</html>
